{"version":3,"file":"ngx-dropzone.js.map","sources":["ng://ngx-dropzone/lib/ngx-dropzone.service.ts","ng://ngx-dropzone/lib/ngx-dropzone.component.ts","ng://ngx-dropzone/lib/ngx-dropzone.module.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\n\nexport interface FilePreview {\n  data: string | ArrayBuffer;\n  filename: string;\n}\n\nexport interface FileSelectResult {\n  addedFiles: File[];\n  rejectedFiles: File[];\n}\n\n/**\n * UPDATE 04.04.2019:\n * Refactored to use service class to handle any\n * logic on the dropped files to allow for easier\n * unit tests and separation of concerns.\n */\n@Injectable()\nexport class NgxDropzoneService {\n\n  constructor() { }\n\n  private fileCache: File[] = [];\n  private rejectedFiles: File[] = [];\n  previews: FilePreview[] = [];\n\n  reset() {\n    this.fileCache = [];\n    this.rejectedFiles = [];\n    this.previews = [];\n  }\n\n  async parseFileList(files: FileList, accept: string, maxFileSize: number, multiple: boolean,\n    preserveFiles: boolean, showPreviews: boolean): Promise<FileSelectResult> {\n\n    /**\n     * UPDATE 27.01.2019:\n     * Refactored the filter algorithm into one filter() method to gain\n     * better performance by iterating only once.\n     * See issue #1.\n     *\n     * UPDATE 09.03.2019:\n     * Refactored to one single loop and fixed bug where disabled multiple\n     * selection might return invalid (unfiltered) files.\n     * Added image preview option.\n     *\n     * UPDATE 12.03.2019:\n     * Refactored to use fileCache and emit all dropped files\n     * since the last reset if [preserveFiles] is true.\n     */\n    const hasFiletypeFilter = accept !== '*';\n\n    /**\n     * UPDATE 12.03.2019:\n     * Added option to preserve preview images.\n     */\n    if (!preserveFiles) {\n      this.fileCache = [];\n      this.rejectedFiles = [];\n      this.previews = [];\n    }\n\n    for (let i = 0; i < files.length; i++) {\n      const file = files.item(i);\n\n      if (hasFiletypeFilter) {\n        if (accept.endsWith('/*')) {\n          // If a generic file type is provided, we check for a match.\n          if (accept.split('/')[0] !== file.type.split('/')[0]) {\n            this.rejectedFiles.push(file);\n            continue;\n          }\n        } else {\n          // Else an exact match is required.\n          if (!accept.includes(file.type)) {\n            this.rejectedFiles.push(file);\n            continue;\n          }\n        }\n      }\n\n      if (maxFileSize && file.size > maxFileSize) {\n        this.rejectedFiles.push(file);\n        continue;\n      }\n\n      if (!multiple && this.fileCache.length >= 1) {\n        if (!preserveFiles) {\n          // Always emit the latest file if multi-selection and preservation are disabled.\n          this.fileCache = [file];\n        } else {\n          continue;\n        }\n      }\n\n      if (showPreviews) {\n        if (file.type.startsWith('image')) {\n          const preview = await this.readFile(file);\n\n          if (preview) {\n            this.previews.push(preview);\n          }\n        } else {\n          const preview: FilePreview = {\n            data: null,\n            filename: file.name\n          };\n\n          this.previews.push(preview);\n        }\n      }\n\n      this.fileCache.push(file);\n    }\n\n    const result: FileSelectResult = {\n      addedFiles: this.fileCache,\n      rejectedFiles: this.rejectedFiles\n    };\n\n    return result;\n  }\n\n  private async readFile(file: File): Promise<FilePreview> {\n    return new Promise<FilePreview>((resolve, reject) => {\n      const reader = new FileReader();\n\n      reader.onload = e => {\n        const preview: FilePreview = {\n          data: (e.target as FileReader).result,\n          filename: file.name\n        };\n\n        return resolve(preview);\n      };\n\n      reader.onerror = e => {\n        console.error(`FileReader failed on file ${file.name}. No preview image created.`);\n        return reject(null);\n      }\n\n      reader.readAsDataURL(file);\n    })\n  }\n}\n","import {\n  Component,\n  Input, Output, ElementRef, ViewChild,\n  AfterViewInit, EventEmitter, TemplateRef,\n  ViewEncapsulation,\n  HostListener,\n  HostBinding\n} from '@angular/core';\nimport { NgxDropzoneService, FilePreview, FileSelectResult } from './ngx-dropzone.service';\nimport { resolve } from 'url';\n\n@Component({\n  selector: 'ngx-dropzone',\n  template: `<input type=\"file\" #fileInput class=\"file-input\" (change)=\"onFilesSelected($event)\" [multiple]=\"multiple\"\n  [accept]=\"accept\" />\n<div class=\"dropzone\" (click)=\"showFileSelector()\">\n  <p *ngIf=\"service.previews.length === 0\">{{ label }}</p>\n  <div class=\"preview\" [class.limit-width]=\"!p.data\" *ngFor=\"let p of service.previews\">\n    <img *ngIf=\"p.data\" [src]=\"p.data\">\n    <span *ngIf=\"p.data\">{{ p.filename }}</span>\n    <div *ngIf=\"!p.data\" class=\"preview-item\">\n      <span>{{ p.filename }}</span>\n    </div>\n  </div>\n</div>\n`,\n  styles: [`:host(){display:flex;height:180px;cursor:pointer;background:#fff;color:#717386;border:2px dashed #717386;border-radius:5px;font-size:16px}:host().hovered{border:2px solid #717386;color:#dfdfe4}:host().disabled{opacity:.5;cursor:no-drop}:host()>.dropzone{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;width:100%;overflow-x:auto}:host()>.dropzone>p{margin:10px auto}:host()>.dropzone>.preview{height:80%;position:relative;text-align:center;padding:0 10px;width:-webkit-max-content;width:-moz-max-content;width:max-content}:host()>.dropzone>.preview.limit-width{max-width:25%}:host()>.dropzone>.preview>img{max-height:100%;border-radius:5px;opacity:.8}:host()>.dropzone>.preview>span{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);color:#fff}:host()>.dropzone>.preview>.preview-item{display:flex;text-align:center;align-items:center;height:100%;padding:0 40px;overflow-wrap:break-word;border-radius:5px;background-image:linear-gradient(to top,#ededed,#efefef,#f1f1f1,#f4f4f4,#f6f6f6)}:host()>.dropzone>.preview>.preview-item>span{color:#717386;max-width:100%}.file-input{display:none}`],\n  providers: [NgxDropzoneService] // Create a new service instance for each component.\n})\nexport class NgxDropzoneComponent {\n\n  constructor(\n    private host: ElementRef,\n    public service: NgxDropzoneService\n  ) { }\n\n  @Input() label = 'Drop your files here (or click)';\n  @Input() multiple = true;\n  @Input() accept = '*';\n  @Input() maxFileSize: number;\n  @Input() showPreviews = false;\n  @Input() preserveFiles = true;\n\n  @Output() filesAdded = new EventEmitter<File[]>();\n  @Output() filesRejected = new EventEmitter<File[]>();\n\n  @HostBinding('class.disabled') @Input() disabled = false;\n  @HostBinding('class.hovered') hovered = false;\n\n  @ViewChild('fileInput') private fileInput: ElementRef;\n\n  showFileSelector() {\n    if (!this.disabled) {\n      this.fileInput.nativeElement.click();\n    }\n  }\n\n  reset() {\n    this.service.reset();\n  }\n\n  onFilesSelected(event) {\n    const files: FileList = event.target.files;\n\n    this.handleFileDrop(files).then(() => {\n      // Reset the file input value to trigger the event on new selection.\n      (this.fileInput.nativeElement as HTMLInputElement).value = '';\n    });\n  }\n\n  /**\n   * UPDATE 10.03.2019:\n   * Refactored to use HostListener and HostBindings to allow\n   * for easier style overwriting from outside the component.\n   */\n  @HostListener('dragover', ['$event'])\n  onDragOver(event) {\n    if (this.disabled) {\n      return;\n    }\n\n    this.preventDefault(event);\n    this.hovered = true;\n  }\n\n  @HostListener('dragleave', ['$event'])\n  onDragLeave(event) {\n    this.hovered = false;\n  }\n\n  @HostListener('drop', ['$event'])\n  onDrop(event) {\n    this.preventDefault(event);\n    this.hovered = false;\n    this.handleFileDrop(event.dataTransfer.files);\n  }\n\n  private async handleFileDrop(files: FileList): Promise<void> {\n    return new Promise<void>(resolve => {\n      if (this.disabled) {\n        return;\n      }\n\n      this.service.parseFileList(files, this.accept, this.maxFileSize,\n        this.multiple, this.preserveFiles, this.showPreviews)\n        .then((result: FileSelectResult) => {\n          this.filesAdded.next(result.addedFiles);\n\n          if (result.rejectedFiles.length) {\n            this.filesRejected.next(result.rejectedFiles);\n          }\n\n          resolve();\n        });\n    });\n  }\n\n  private preventDefault(event: DragEvent) {\n    event.preventDefault();\n    event.stopPropagation();\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { NgxDropzoneComponent } from './ngx-dropzone.component';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  declarations: [\n    NgxDropzoneComponent\n  ],\n  exports: [\n    NgxDropzoneComponent\n  ]\n})\nexport class NgxDropzoneModule { }\n"],"names":[],"mappings":";;;;;;;;;;;;;;AAkBA;IAGE;QAEQ,cAAS,GAAW,EAAE,CAAC;QACvB,kBAAa,GAAW,EAAE,CAAC;QACnC,aAAQ,GAAkB,EAAE,CAAC;KAJZ;;;;IAMjB,kCAAK;;;IAAL;QACE,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;QACpB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;QACxB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;KACpB;;;;;;;;;;IAEK,0CAAa;;;;;;;;;IAAnB,UAAoB,KAAe,EAAE,MAAc,EAAE,WAAmB,EAAE,QAAiB,EACzF,aAAsB,EAAE,YAAqB;;;;;;wBAiBvC,iBAAiB,GAAG,MAAM,KAAK,GAAG;;;;;wBAMxC,IAAI,CAAC,aAAa,EAAE;4BAClB,IAAI,CAAC,SAAS,GAAG,EAAE,CAAC;4BACpB,IAAI,CAAC,aAAa,GAAG,EAAE,CAAC;4BACxB,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC;yBACpB;wBAEQ,CAAC,GAAG,CAAC;;;8BAAE,CAAC,GAAG,KAAK,CAAC,MAAM,CAAA;wBACxB,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;wBAE1B,IAAI,iBAAiB,EAAE;4BACrB,IAAI,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAE;;gCAEzB,IAAI,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,KAAK,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE;oCACpD,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oCAC9B,wBAAS;iCACV;6BACF;iCAAM;;gCAEL,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;oCAC/B,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;oCAC9B,wBAAS;iCACV;6BACF;yBACF;wBAED,IAAI,WAAW,IAAI,IAAI,CAAC,IAAI,GAAG,WAAW,EAAE;4BAC1C,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;4BAC9B,wBAAS;yBACV;wBAED,IAAI,CAAC,QAAQ,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,IAAI,CAAC,EAAE;4BAC3C,IAAI,CAAC,aAAa,EAAE;;gCAElB,IAAI,CAAC,SAAS,GAAG,CAAC,IAAI,CAAC,CAAC;6BACzB;iCAAM;gCACL,wBAAS;6BACV;yBACF;6BAEG,YAAY,EAAZ,wBAAY;6BACV,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,OAAO,CAAC,EAA7B,wBAA6B;wBACf,qBAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,EAAA;;wBAAnC,OAAO,GAAG,SAAyB;wBAEzC,IAAI,OAAO,EAAE;4BACX,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;yBAC7B;;;wBAEK,OAAO,GAAgB;4BAC3B,IAAI,EAAE,IAAI;4BACV,QAAQ,EAAE,IAAI,CAAC,IAAI;yBACpB;wBAED,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;;;wBAIhC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;;;wBAlDM,CAAC,EAAE,CAAA;;;wBAqD/B,MAAM,GAAqB;4BAC/B,UAAU,EAAE,IAAI,CAAC,SAAS;4BAC1B,aAAa,EAAE,IAAI,CAAC,aAAa;yBAClC;wBAED,sBAAO,MAAM,EAAC;;;;KACf;;;;;;IAEa,qCAAQ;;;;;IAAtB,UAAuB,IAAU;;;gBAC/B,sBAAO,IAAI,OAAO;;;;;oBAAc,UAAC,OAAO,EAAE,MAAM;;4BACxC,MAAM,GAAG,IAAI,UAAU,EAAE;wBAE/B,MAAM,CAAC,MAAM;;;;wBAAG,UAAA,CAAC;;gCACT,OAAO,GAAgB;gCAC3B,IAAI,EAAE,oBAAC,CAAC,CAAC,MAAM,IAAgB,MAAM;gCACrC,QAAQ,EAAE,IAAI,CAAC,IAAI;6BACpB;4BAED,OAAO,OAAO,CAAC,OAAO,CAAC,CAAC;yBACzB,CAAA,CAAC;wBAEF,MAAM,CAAC,OAAO;;;;wBAAG,UAAA,CAAC;4BAChB,OAAO,CAAC,KAAK,CAAC,+BAA6B,IAAI,CAAC,IAAI,gCAA6B,CAAC,CAAC;4BACnF,OAAO,MAAM,CAAC,IAAI,CAAC,CAAC;yBACrB,CAAA,CAAA;wBAED,MAAM,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;qBAC5B,EAAC,EAAA;;;KACH;;gBA9HF,UAAU;;;;IA+HX,yBAAC;CAAA;;;;;;;IClHC,8BACU,IAAgB,EACjB,OAA2B;QAD1B,SAAI,GAAJ,IAAI,CAAY;QACjB,YAAO,GAAP,OAAO,CAAoB;QAG3B,UAAK,GAAG,iCAAiC,CAAC;QAC1C,aAAQ,GAAG,IAAI,CAAC;QAChB,WAAM,GAAG,GAAG,CAAC;QAEb,iBAAY,GAAG,KAAK,CAAC;QACrB,kBAAa,GAAG,IAAI,CAAC;QAEpB,eAAU,GAAG,IAAI,YAAY,EAAU,CAAC;QACxC,kBAAa,GAAG,IAAI,YAAY,EAAU,CAAC;QAEb,aAAQ,GAAG,KAAK,CAAC;QAC3B,YAAO,GAAG,KAAK,CAAC;KAbzC;;;;IAiBL,+CAAgB;;;IAAhB;QACE,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAClB,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,KAAK,EAAE,CAAC;SACtC;KACF;;;;IAED,oCAAK;;;IAAL;QACE,IAAI,CAAC,OAAO,CAAC,KAAK,EAAE,CAAC;KACtB;;;;;IAED,8CAAe;;;;IAAf,UAAgB,KAAK;QAArB,iBAOC;;YANO,KAAK,GAAa,KAAK,CAAC,MAAM,CAAC,KAAK;QAE1C,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC,IAAI;;;QAAC;;YAE9B,oBAAC,KAAI,CAAC,SAAS,CAAC,aAAa,IAAsB,KAAK,GAAG,EAAE,CAAC;SAC/D,EAAC,CAAC;KACJ;;;;;;;;;;;;;IAQD,yCAAU;;;;;;;IADV,UACW,KAAK;QACd,IAAI,IAAI,CAAC,QAAQ,EAAE;YACjB,OAAO;SACR;QAED,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAC3B,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC;KACrB;;;;;IAGD,0CAAW;;;;IADX,UACY,KAAK;QACf,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;KACtB;;;;;IAGD,qCAAM;;;;IADN,UACO,KAAK;QACV,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,CAAC;QAC3B,IAAI,CAAC,OAAO,GAAG,KAAK,CAAC;QACrB,IAAI,CAAC,cAAc,CAAC,KAAK,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;KAC/C;;;;;;IAEa,6CAAc;;;;;IAA5B,UAA6B,KAAe;;;;gBAC1C,sBAAO,IAAI,OAAO;;;;oBAAO,UAAA,OAAO;wBAC9B,IAAI,KAAI,CAAC,QAAQ,EAAE;4BACjB,OAAO;yBACR;wBAED,KAAI,CAAC,OAAO,CAAC,aAAa,CAAC,KAAK,EAAE,KAAI,CAAC,MAAM,EAAE,KAAI,CAAC,WAAW,EAC7D,KAAI,CAAC,QAAQ,EAAE,KAAI,CAAC,aAAa,EAAE,KAAI,CAAC,YAAY,CAAC;6BACpD,IAAI;;;;wBAAC,UAAC,MAAwB;4BAC7B,KAAI,CAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,CAAC;4BAExC,IAAI,MAAM,CAAC,aAAa,CAAC,MAAM,EAAE;gCAC/B,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,CAAC;6BAC/C;4BAED,OAAO,EAAE,CAAC;yBACX,EAAC,CAAC;qBACN,EAAC,EAAC;;;KACJ;;;;;;IAEO,6CAAc;;;;;IAAtB,UAAuB,KAAgB;QACrC,KAAK,CAAC,cAAc,EAAE,CAAC;QACvB,KAAK,CAAC,eAAe,EAAE,CAAC;KACzB;;gBA7GF,SAAS,SAAC;oBACT,QAAQ,EAAE,cAAc;oBACxB,QAAQ,EAAE,8jBAYX;oBACC,MAAM,EAAE,CAAC,qpCAAqpC,CAAC;oBAC/pC,SAAS,EAAE,CAAC,kBAAkB,CAAC;iBAChC;;;;gBA1BgB,UAAU;gBAMlB,kBAAkB;;;wBA4BxB,KAAK;2BACL,KAAK;yBACL,KAAK;8BACL,KAAK;+BACL,KAAK;gCACL,KAAK;6BAEL,MAAM;gCACN,MAAM;2BAEN,WAAW,SAAC,gBAAgB,cAAG,KAAK;0BACpC,WAAW,SAAC,eAAe;4BAE3B,SAAS,SAAC,WAAW;6BA0BrB,YAAY,SAAC,UAAU,EAAE,CAAC,QAAQ,CAAC;8BAUnC,YAAY,SAAC,WAAW,EAAE,CAAC,QAAQ,CAAC;yBAKpC,YAAY,SAAC,MAAM,EAAE,CAAC,QAAQ,CAAC;;IA+BlC,2BAAC;CAAA;;;;;;ACzHD;IAIA;KAWkC;;gBAXjC,QAAQ,SAAC;oBACR,OAAO,EAAE;wBACP,YAAY;qBACb;oBACD,YAAY,EAAE;wBACZ,oBAAoB;qBACrB;oBACD,OAAO,EAAE;wBACP,oBAAoB;qBACrB;iBACF;;IACgC,wBAAC;CAAA;;;;;;;;;;;;;;"}
